{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  query getItemGroup($itemID: String) {\\n    getItemGroup(itemID: $itemID) {\\n      item\\n    }\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  query getItems(\\n    $search: String\\n    $limit: Int\\n    $sort: String\\n    $pageNum: Int\\n    $exclude: Json\\n    $include: Json\\n    $priceCurrency: String\\n    $price: String\\n    $itemLocationCountry: String\\n  ) {\\n    getItems(\\n      search: $search\\n      limit: $limit\\n      sort: $sort\\n      pageNum: $pageNum\\n      exclude: $exclude\\n      include: $include\\n      priceCurrency: $priceCurrency\\n      price: $price\\n      itemLocationCountry: $itemLocationCountry\\n    ) {\\n      item\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from 'react';\nimport Link from 'next/link';\nimport { gql } from 'apollo-boost';\nimport { Pane, Heading, Text, SearchInput, Icon, TextInput, IconButton, Spinner, TagInput, toaster, Tablist, Tab, Avatar } from 'evergreen-ui';\nimport { Query } from 'react-apollo';\nimport Product from './findListItem/Product';\nimport AmzProduct from './findListItem/AmzProduct';\nimport User from '../user/User';\nimport Pagination from '../common/Pagination';\nimport TextButton from '../common/Button';\nimport { CardStyle } from '../common/DefaultStyles';\nimport { front, prodFront } from '../../config';\nvar getItems = gql(_templateObject());\nexport var getItemGroup = gql(_templateObject2());\nvar sortOptions = [{\n  label: 'Lowest Price',\n  value: 'price'\n}, {\n  label: 'Highest Price',\n  value: '-price'\n}, {\n  label: 'Best Match',\n  value: 'match'\n}];\n\nvar option = function option(name, options, update, selected) {\n  return React.createElement(Pane, {\n    marginBottom: 10,\n    marginRight: 10\n  }, React.createElement(Heading, {\n    size: 500,\n    fontSize: \"12px\",\n    fontWeight: 500,\n    marginBottom: 2\n  }, name), React.createElement(Tablist, null, options.map(function (a, index) {\n    return React.createElement(Tab, {\n      key: a,\n      id: a,\n      marginLeft: 0,\n      height: \"20px\",\n      fontSize: \"10px\",\n      marginBottom: 3,\n      letterSpacing: \"0.3px\",\n      fontWeight: 400,\n      textTransform: \"uppercase\",\n      onSelect: function onSelect() {\n        return update(a);\n      },\n      isSelected: a === selected,\n      \"aria-controls\": \"panel-\".concat(a)\n    }, a);\n  })));\n};\n\nvar Find =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Find, _Component);\n\n  function Find() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Find);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Find)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      sort: {\n        label: 'Lowest Price',\n        value: 'price'\n      },\n      searchBar: '',\n      searchEntry: null,\n      limit: 10,\n      pageNum: 0,\n      min: '',\n      max: '',\n      price: null,\n      priceCurrency: 'USD',\n      itemLocationCountry: 'US',\n      include: [],\n      exclude: [],\n      selectedChannel: 'zinc',\n      zincResults: []\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"zincSearch\", function (searchEntry, token) {\n      console.log('called');\n      fetch(\"\".concat(process.env.NODE_ENV === 'development' ? front : prodFront, \"/api/zinc/search?query=\").concat(searchEntry, \"&token=\").concat(token)).then(function (res) {\n        return res.json();\n      }).then(function (json) {\n        return _this.setState({\n          zincResults: json\n        });\n      })[\"catch\"](function (error) {\n        return console.log('Error: ', error);\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(Find, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          headerSize = _this$props.headerSize,\n          atcDisabled = _this$props.atcDisabled,\n          addMPItem = _this$props.addMPItem,\n          _addZincItem = _this$props.addZincItem;\n      var _this$state = this.state,\n          pageNum = _this$state.pageNum,\n          searchBar = _this$state.searchBar,\n          sort = _this$state.sort,\n          limit = _this$state.limit,\n          itemLocationCountry = _this$state.itemLocationCountry,\n          selectedChannel = _this$state.selectedChannel,\n          min = _this$state.min,\n          max = _this$state.max,\n          include = _this$state.include,\n          exclude = _this$state.exclude,\n          searchEntry = _this$state.searchEntry,\n          priceCurrency = _this$state.priceCurrency,\n          price = _this$state.price,\n          zincResults = _this$state.zincResults;\n      return React.createElement(React.Fragment, null, React.createElement(Pane, {\n        display: \"flex\",\n        paddingTop: 16,\n        paddingBottom: 16\n      }, React.createElement(Pane, {\n        flex: 1,\n        alignItems: \"center\",\n        display: \"flex\"\n      }, React.createElement(Heading, {\n        size: headerSize || 700\n      }, \"Marketplace\"))), React.createElement(Pane, _extends({}, CardStyle, {\n        background: \"white\"\n      }), React.createElement(User, null, function (_ref) {\n        var me = _ref.data.me;\n        if (!me) return null;\n\n        if (me.buyer && me.buyer.status) {\n          return React.createElement(React.Fragment, null, React.createElement(Pane, {\n            display: \"flex\",\n            paddingX: \"1em\",\n            paddingY: \"1em\",\n            flexWrap: \"wrap\"\n          }, React.createElement(Pagination, {\n            leftDisabled: pageNum === 0,\n            onLeft: function onLeft() {\n              return _this2.setState(function (state) {\n                return {\n                  pageNum: state.pageNum - 1\n                };\n              });\n            },\n            onRight: function onRight() {\n              return _this2.setState(function (state) {\n                return {\n                  pageNum: state.pageNum + 1\n                };\n              });\n            }\n          }), React.createElement(Pane, {\n            flex: 1\n          }, React.createElement(SearchInput, {\n            placeholder: \"Search\",\n            boxShadow: \"none\",\n            width: \"100%\",\n            height: 36,\n            value: searchBar,\n            onChange: function onChange(e) {\n              return _this2.setState({\n                searchBar: e.target.value,\n                pageNum: 0\n              });\n            },\n            onKeyPress: function onKeyPress(e) {\n              if (e.key === 'Enter') {\n                _this2.setState(function (state) {\n                  return {\n                    searchEntry: state.searchBar\n                  };\n                });\n\n                if (selectedChannel === 'zinc') {\n                  _this2.zincSearch(searchBar, me.zincToken);\n                }\n              }\n            }\n          }))), React.createElement(Pane, {\n            display: \"flex\",\n            flexWrap: \"wrap\",\n            background: \"#f5f5f5\",\n            paddingY: \".7em\",\n            paddingX: \"1em\"\n          }, option('Channel', ['zinc', 'marketplace'], function (a) {\n            return _this2.setState({\n              selectedChannel: a\n            });\n          }, selectedChannel), option('Location', ['US', 'CN', 'All'], function (a) {\n            return _this2.setState({\n              itemLocationCountry: a\n            });\n          }, itemLocationCountry), option('Items per page', [10, 50, 100], function (a) {\n            return _this2.setState({\n              limit: a\n            });\n          }, limit)), searchEntry && selectedChannel === 'marketplace' && React.createElement(Query, {\n            query: getItems,\n            variables: {\n              search: searchEntry,\n              limit: limit,\n              sort: sort.value,\n              pageNum: pageNum,\n              exclude: exclude,\n              include: include,\n              priceCurrency: priceCurrency,\n              price: price,\n              itemLocationCountry: itemLocationCountry\n            }\n          }, function (_ref2) {\n            var data = _ref2.data,\n                error = _ref2.error,\n                loading = _ref2.loading;\n            if (loading) return React.createElement(Pane, {\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              height: \"100vh\"\n            }, React.createElement(Spinner, {\n              size: 80\n            }));\n            if (error || !data.getItems.item || data.getItems.item.length < 1) return React.createElement(Pane, {\n              paddingX: \"1em\",\n              paddingY: \"1em\"\n            }, React.createElement(Pane, {\n              background: \"tint2\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              flexDirection: \"column\",\n              borderRadius: 3\n            }, React.createElement(Heading, {\n              margin: \"1em\",\n              size: 600\n            }, \"No items found.\")));\n            return React.createElement(React.Fragment, null, data.getItems.item.data.products.edges.map(function (product) {\n              return React.createElement(Product, {\n                addVariantToCart: function addVariantToCart(a, b) {\n                  return addMPItem(a, b);\n                },\n                checkout: function checkout() {\n                  return toaster.success(\"checkout\");\n                },\n                key: product.node.id.toString(),\n                product: product.node,\n                client: \"Marketplace\",\n                atcDisabled: atcDisabled\n              });\n            }));\n          }), selectedChannel === 'zinc' && zincResults.length > 0 && zincResults.map(function (product) {\n            return React.createElement(AmzProduct, {\n              product: product,\n              addVariantToCart: function addVariantToCart(a) {\n                return toaster.success(a);\n              },\n              atcDisabled: atcDisabled,\n              addZincItem: function addZincItem(a, b, c, d, e) {\n                return _addZincItem(a, b, c, d, e);\n              }\n            });\n          }));\n        }\n\n        return React.createElement(Pane, {\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          width: \"100%\",\n          height: \"200px\"\n        }, React.createElement(Link, {\n          href: \"/settings\"\n        }, React.createElement(\"a\", null, React.createElement(TextButton, {\n          intent: \"primary\",\n          height: 30,\n          fontSize: 16\n        }, \"Apply for Beta Access\"))));\n      })));\n    }\n  }]);\n\n  return Find;\n}(Component);\n\nexport { Find as default };","map":null,"metadata":{},"sourceType":"module"}